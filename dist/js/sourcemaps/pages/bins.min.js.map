{"version":3,"sources":["pages/bins.js"],"names":["$","document","ready","display","page","bins","load","toggleLoadingScreen","etsyDB","getAll","drawBins","append","appendString","each","key","val","bin","binTemplate","removeClass","find","html","id","name","total","notes","attr","bin_actions","bin-id","toString","bin-name","bin-notes","bin-total","binsTableBody","getElementById","innerHTML","updateBin","bin_row","removeBin","bin_id","fadeOut","this","remove","drawBinContents","bin_products","product_data","product","binProductTemplate","product_url","listing_id","title","price","moment","created","format","original_creation","all_product_actions","all-product-id","all-product-title","all-product-bin-id","binProductTableBody","openModal","clone","on","getContents","bin_name","bin_notes","toastInfo","closeModal","add","addClass","toastError","update","getQRCode","labelSizes","image","font","labelImageSize","labelFontSize","printWindow","window","open","windowContent","body","css","position","left","transform","width","textAlign","top","fontSize","fontWeight","wordWrap","print"],"mappings":"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","file":"pages/bins.min.js","sourcesContent":["$(document).ready(function() {\n    $.display.page.bins = {\n        load: function() {\n            $.display.toggleLoadingScreen($.etsyDB.bins.getAll($.display.page.bins.drawBins));\n        },\n\n        // Draw bins table\n        drawBins: function(bins, append) {\n            append = typeof append !== 'undefined' ? append : false;\n            var appendString = '';\n            $.each(bins, function(key, val) {\n                var bin = binTemplate;\n                bin.removeClass('template');\n                bin.find('.bin-id').html(val.id);\n                bin.find('.bin-name').html(val.name);\n                bin.find('.bin-total').html(val.total);\n                bin.find('.bin-notes')\n                    .html(val.notes)\n                    .attr('title', val.notes);\n\n                var bin_actions = bin.find('.bin-actions');\n                bin_actions.find('.btn-floating').attr({\n                    \"bin-id\": val.id.toString(),\n                    \"bin-name\": val.name,\n                    \"bin-notes\": val.notes,\n                    \"bin-total\": val.total\n                });\n\n                appendString += ('<tr id=\"bin-row-' + val.id.toString() + '\">' + bin.html() + '</tr>');\n            });\n\n            if (append) {\n                $('#binsTableBody').append(appendString);\n            } else {\n                // Try and cut some repaint time by using vanilla JS\n                var binsTableBody = document.getElementById('binsTableBody');\n                binsTableBody.innerHTML = appendString;\n            }\n        },\n\n        // Update bin info display\n        updateBin: function(bin) {\n            var bin_row = $('#bin-row-' + bin.id);\n            bin_row.find('.bin-name').html(bin.name);\n            bin_row.find('.bin-notes')\n                .html(bin.notes)\n                .attr('title', bin.notes);\n        },\n\n        // Remove bin row\n        removeBin: function(bin_id) {\n            $('#bin-row-' + bin_id).fadeOut('slow', function() {\n                $(this).remove();\n            });\n        },\n\n        // Draw bin contents modal\n        drawBinContents: function(bin_products) {\n            var appendString = '';\n\n            $.each(bin_products, function(key, product_data) {\n                var product = binProductTemplate;\n                product.removeClass('template');\n\n                var product_url = product.find('.listing-url');\n                product_url.attr('href', 'http://www.etsy.com/listing/' + product_data.listing_id);\n                product_url.attr('title', product_data.title);\n                product_url.html(product_data.title);\n                product.find('.price').html(product_data.price);\n                product.find('.created').html(moment(product_data.created).format('MMM D, h:mm a'));\n                product.find('.original-created').html(moment(product_data.original_creation).format('MMM D, h:mm a'));\n\n                var all_product_actions = product.find('.all-product-actions');\n                all_product_actions.find('.btn-floating').attr({\n                    \"all-product-id\": product_data.id.toString(),\n                    \"all-product-title\": product_data.title,\n                    \"all-product-bin-id\": product_data.bin_id\n                });\n\n                appendString += ('<tr id=\"bin-product-row-' + product_data.id + '\">' + product.html() + '</tr>');\n            });\n\n            // Try and cut some repaint time by using vanilla JS\n            var binProductTableBody = document.getElementById('binProductTableBody');\n            binProductTableBody.innerHTML = appendString;\n\n            $('#modalViewBinContents').openModal();\n        }\n    };\n\n    var binTemplate = $('#binTemplate').clone();\n    $('#binTemplate').remove();\n\n    var binProductTemplate = $('#binProductTemplate').clone();\n    $('#binProductTemplate').remove();\n\n    // Reload bins\n    $('#reloadBins').on('click', function() {\n        $.display.page.bins.load();\n    });\n\n    // Open bin view contents modal\n    $('body').on('click', '.btn-view-bin', function() {\n        $('#viewBinProductsName').html($(this).attr('bin-name'));\n        $.etsyDB.bins.getContents($(this).attr('bin-id'), $.display.page.bins.drawBinContents);\n    });\n\n    // Create new bin\n    $('#createBin').on('click', function() {\n        var bin_name = $('#binCreateName').val();\n        var bin_notes = $('#binCreateNotes').val();\n\n        if (bin_name === '') $.display.toastInfo('Please enter a bin name');\n        else {\n            $('#modalCreateBin').closeModal();\n            $.etsyDB.bins.add(bin_name, bin_notes, $.display.page.bins.drawBins);\n            $('#binCreateName').val('');\n            $('#binCreateNotes').val('');\n        }\n    });\n\n    // Open bin edit modal\n    $('body').on('click', '.btn-edit-bin', function() {\n        $('#binEditID').val($(this).attr('bin-id'));\n        $(\"label[for='binEditID']\").addClass('active');\n\n        $('#binEditName').val($(this).attr('bin-name'));\n        $(\"label[for='binEditName']\").addClass('active');\n\n        $('#binEditNotes').val($(this).attr('bin-notes'));\n        $(\"label[for='binEditNotes']\").addClass('active');\n\n        $('#modalEditBin').openModal();\n    });\n\n    // Edit bin info\n    $('#editBin').on('click', function() {\n        if ($('#binEditName').val() === '') $.display.toastError('Bin name cannot be empty!');\n        else {\n            $.etsyDB.bins.update($('#binEditID').val(), $('#binEditName').val(), $('#binEditNotes').val(), $.display.page.bins.updateBin);\n            $('#modalEditBin').closeModal();\n        }\n    });\n\n    // Open bin print label modal\n    $('body').on('click', '.btn-print-bin', function() {\n        $('#previewTitle').html($(this).attr('bin-name'));\n        $('#previewImage').attr('src', $.display.getQRCode('Bin-ID:' + $(this).attr('bin-id'), 250));\n        $('#modalPrintBinLabel').openModal();\n    });\n\n    // Confirm bin deletion\n    $('body').on('click', '.btn-remove-bin', function() {\n        $('.binDeleteName').html($(this).attr('bin-name'));\n        $('#binDeleteID').html($(this).attr('bin-id'));\n        $('.binDeleteTotal').html($(this).attr('bin-total'));\n        $('#modalDeleteBin').openModal();\n    });\n\n    // Delete bin after confirmation\n    $('body').on('click', '#confirmDeleteBin', function() {\n        $('#modalDeleteBin').closeModal();\n        $.etsyDB.bins.delete($('#binDeleteID').html(), $('.binDeleteName').html(), $.display.page.bins.removeBin);\n    });\n\n    // Update label size display on change\n    $('input[type=radio][name=label-size]').on('change', function() {\n        $('#labelImageSize').val($.display.labelSizes[$(this).attr('id')].image);\n        $('#labelFontSize').val($.display.labelSizes[$(this).attr('id')].font);\n    });\n\n    // Print bin label\n    $('#printBin').on('click', function() {\n        var labelImageSize = $('#labelImageSize').val(),\n            labelFontSize = $('#labelFontSize').val(),\n            printWindow = window.open('', \"Test Window\", \"height=600,width=800\"),\n            windowContent = printWindow.document.body;\n        $('#modalPrintBinLabel').closeModal();\n        windowContent.title = 'Test';\n        $(windowContent).html($('#printPreview').html());\n        $(windowContent).find('#previewImage').attr('src', $.display.getQRCode('Bin-ID:' + $(this).attr('bin-id'), labelImageSize));\n\n        $(windowContent).find('#previewImage').css({\n            position: 'relative',\n            left: '50%',\n            transform: 'translateX(-50%)',\n            width: labelImageSize + 'px'\n        });\n        $(windowContent).find('#previewTitle').css({\n            position: 'relative',\n            left: '50%',\n            transform: 'translateX(-50%)',\n            width: labelImageSize + 'px',\n            textAlign: 'center',\n            top: '-1em',\n            fontSize: labelFontSize + 'px',\n            fontWeight: 'bold',\n            wordWrap: 'break-word'\n        });\n        printWindow.print();\n    });\n});"],"sourceRoot":"/source/"}