$(document).ready(function(){$.etsyDB={init:function(){$.db=new Dexie("etsyDB"),Dexie.getDatabaseNames(function(e){-1==e.indexOf("etsyDB")?$.etsyDB.create():($.db.open(),$.etsyApp.settings.firstRun=!1)})},create:function(){$.db.version(1).stores({products:"++id, bin_id, listing_id, title, categories, price, created, original_created",bins:"++id, name, notes"}),console.log("Created database"),$.db.open()},listTables:function(){$.db.tables.forEach(function(e,t){console.log("Table "+t+": "+e.name)})},"delete":function(){$.db["delete"]().then(function(){console.log("Deleted database")})},"export":function(){return $.db.transaction("r",$.db.tables,function(){function e(){var i=t.shift();return i.toArray().then(function(a){return n.push({tableName:i.name,contents:a}),t.length>0?e():n})}var t=$.db.tables.map(function(e){return Dexie.currentTransaction.tables[e.name]}),n=[];return e()})},products:{add:function(e){$.db.table("products").where("listing_id").equals(e.listing_id).count(function(t){0===t&&$.db.table("products").add({bin_id:-1,listing_id:e.listing_id,title:e.title,categories:e.category_path.toString(),price:e.price,created:e.creation_tsz,original_creation:e.original_creation_tsz}).then(function(){console.log("Added listing #"+e.listing_id)})})},getNew:function(e){$.db.table("products").where("bin_id").equals(-1).toArray().then(function(t){e(t)})},getAll:function(e){$.db.table("products").toArray().then(function(t){e(t)})}},bins:{getAll:function(e){var t=[];$.db.table("bins").each(function(e){$.db.table("products").where("bin_id").equals(e.id).count(function(n){e.total=n,t.push(e)})}).then(function(){e(t)})},add:function(e,t){$.db.table("bins").where("name").equals(e).count(function(n){0===n?$.db.table("bins").add({name:e,notes:t}).then(function(){Materialize.toast("Created bin '"+e+"' succesfully",4e3),$.display.updateCounts()}):Materialize.toast("Bin '"+e+"' already exists!",4e3)})},"delete":function(e,t){$.db.table("bins").where("id").equals(e)["delete"]().then(function(){Materialize.toast("Bin #"+e+" - '"+t+"' deleted succesfully",4e3)})}}}});
//# sourceMappingURL=../_sourcemaps/lib/etsy_db.min.js.map